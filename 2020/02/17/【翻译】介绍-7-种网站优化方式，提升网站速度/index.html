<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"xuquan.site","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="网站内容显示的速度会决定网站的排名。 你需要优化来获得最高排名。除此之外，你的用户也会因此感谢你，当然也可能压根没注意到——这是件好事。 在这篇文章里，我会告诉你一些提升网站速度的方法。 让我们开始吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="【翻译】介绍 7 种网站优化方式，提升网站速度">
<meta property="og:url" content="https://xuquan.site/2020/02/17/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91%E4%BB%8B%E7%BB%8D-7-%E7%A7%8D%E7%BD%91%E7%AB%99%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%8F%90%E5%8D%87%E7%BD%91%E7%AB%99%E9%80%9F%E5%BA%A6/index.html">
<meta property="og:site_name" content="Nikkkki&#39;s Notes">
<meta property="og:description" content="网站内容显示的速度会决定网站的排名。 你需要优化来获得最高排名。除此之外，你的用户也会因此感谢你，当然也可能压根没注意到——这是件好事。 在这篇文章里，我会告诉你一些提升网站速度的方法。 让我们开始吧。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gattxfqr8tj30k00fvwf6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gatubnx4y7j30k00fvt9a.jpg">
<meta property="og:image" content="https://www.jaredwolff.com/seven-ways-to-optimize-your-site-for-speed/images/Copy_of_Particle_Bluetooth-385a56b6-9f74-4a2d-9ab3-fd0ef8daa8a4.png">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gaty77uourj30k008xgm1.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gaty724zg6j30k00kct9a.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gatyf1p4x0j30k00eqdg7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gau3sep6b0j30k00b9aa3.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gau4f1u1inj30k00b9jrh.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gau4uj2cztj30k00fvdgo.jpg">
<meta property="article:published_time" content="2020-02-16T16:10:17.000Z">
<meta property="article:modified_time" content="2020-02-17T03:36:16.000Z">
<meta property="article:author" content="Xu Quan（Nikkkki）">
<meta property="article:tag" content="translation">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1gattxfqr8tj30k00fvwf6.jpg">


<link rel="canonical" href="https://xuquan.site/2020/02/17/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91%E4%BB%8B%E7%BB%8D-7-%E7%A7%8D%E7%BD%91%E7%AB%99%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%8F%90%E5%8D%87%E7%BD%91%E7%AB%99%E9%80%9F%E5%BA%A6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://xuquan.site/2020/02/17/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91%E4%BB%8B%E7%BB%8D-7-%E7%A7%8D%E7%BD%91%E7%AB%99%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%8F%90%E5%8D%87%E7%BD%91%E7%AB%99%E9%80%9F%E5%BA%A6/","path":"2020/02/17/【翻译】介绍-7-种网站优化方式，提升网站速度/","title":"【翻译】介绍 7 种网站优化方式，提升网站速度"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【翻译】介绍 7 种网站优化方式，提升网站速度 | Nikkkki's Notes</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Nikkkki's Notes</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%86%E8%A7%A3%E6%A0%87%E5%87%86"><span class="nav-number">1.</span> <span class="nav-text">了解标准</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Lighthouse"><span class="nav-number">2.</span> <span class="nav-text">使用 Lighthouse</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2"><span class="nav-number"></span> <span class="nav-text">使用静态页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E7%94%9F%E6%88%90%E5%99%A8%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%EF%BC%9F"><span class="nav-number">1.</span> <span class="nav-text">静态网站生成器如何工作？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B0%E5%AF%8C%E7%9A%84%E6%8F%92%E4%BB%B6"><span class="nav-number">2.</span> <span class="nav-text">丰富的插件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B5%8C%E5%85%A5-JavaScript-%E5%92%8C-CSS"><span class="nav-number"></span> <span class="nav-text">嵌入 JavaScript 和 CSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%86%85%E7%BD%AE%E6%96%B9%E6%B3%95"><span class="nav-number"></span> <span class="nav-text">使用内置方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E7%BB%87%E4%BB%A3%E7%A0%81"><span class="nav-number"></span> <span class="nav-text">组织代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD"><span class="nav-number"></span> <span class="nav-text">延迟加载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD"><span class="nav-number">1.</span> <span class="nav-text">设置延迟加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%81%E8%AF%81%E5%A5%87%E8%BF%B9%E7%9A%84%E6%97%B6%E5%88%BB"><span class="nav-number">2.</span> <span class="nav-text">见证奇迹的时刻</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Gulp-%E5%AE%9E%E7%8E%B0%E4%BC%98%E5%8C%96"><span class="nav-number"></span> <span class="nav-text">使用 Gulp 实现优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B"><span class="nav-number">1.</span> <span class="nav-text">案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%BB%E7%B9%81%E5%B0%B1%E7%AE%80"><span class="nav-number"></span> <span class="nav-text">去繁就简</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%AB%99%E8%AF%8A%E6%96%AD"><span class="nav-number"></span> <span class="nav-text">网站诊断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B0%B8%E6%97%A0%E6%AD%A2%E5%A2%83"><span class="nav-number"></span> <span class="nav-text">永无止境</span></a></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xu Quan（Nikkkki）"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Xu Quan（Nikkkki）</p>
  <div class="site-description" itemprop="description">一个程序员的自我进修之路</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">199</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">113</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/XuQuan-nikkkki" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;XuQuan-nikkkki" rel="noopener me" target="_blank"><i class="fa-brands fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:xuquan1225@gmail.com" title="E-Mail → mailto:xuquan1225@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.douban.com/people/nikkkki/?_i=8570912tq6k9lM" title="Douban → https:&#x2F;&#x2F;www.douban.com&#x2F;people&#x2F;nikkkki&#x2F;?_i&#x3D;8570912tq6k9lM" rel="noopener me" target="_blank"><i class="fa fa-book fa-fw"></i>Douban</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xuquan.site/2020/02/17/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91%E4%BB%8B%E7%BB%8D-7-%E7%A7%8D%E7%BD%91%E7%AB%99%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%8F%90%E5%8D%87%E7%BD%91%E7%AB%99%E9%80%9F%E5%BA%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Xu Quan（Nikkkki）">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nikkkki's Notes">
      <meta itemprop="description" content="一个程序员的自我进修之路">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【翻译】介绍 7 种网站优化方式，提升网站速度 | Nikkkki's Notes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【翻译】介绍 7 种网站优化方式，提升网站速度
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-02-17 00:10:17 / 修改时间：11:36:16" itemprop="dateCreated datePublished" datetime="2020-02-17T00:10:17+08:00">2020-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BF%BB%E8%AF%91/" itemprop="url" rel="index"><span itemprop="name">翻译</span></a>
        </span>
    </span>

  
    <span id="/2020/02/17/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91%E4%BB%8B%E7%BB%8D-7-%E7%A7%8D%E7%BD%91%E7%AB%99%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%8F%90%E5%8D%87%E7%BD%91%E7%AB%99%E9%80%9F%E5%BA%A6/" class="post-meta-item leancloud_visitors" data-flag-title="【翻译】介绍 7 种网站优化方式，提升网站速度" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/02/17/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91%E4%BB%8B%E7%BB%8D-7-%E7%A7%8D%E7%BD%91%E7%AB%99%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%8C%E6%8F%90%E5%8D%87%E7%BD%91%E7%AB%99%E9%80%9F%E5%BA%A6/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/02/17/【翻译】介绍-7-种网站优化方式，提升网站速度/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>网站内容显示的速度会决定网站的排名。</p>
<p>你需要优化来获得最高排名。除此之外，你的用户也会因此感谢你，当然也可能压根没注意到——这是件好事。</p>
<p>在这篇文章里，我会告诉你一些提升网站速度的方法。</p>
<p>让我们开始吧。</p>
<span id="more"></span>

<h3 id="了解标准"><a href="#了解标准" class="headerlink" title="了解标准"></a>了解标准</h3><p>首先，用你的网站来做示例。</p>
<p>你需要使用 Google 的 <a target="_blank" rel="noopener" href="https://developers.google.com/speed/pagespeed/insights/">Pagespeed Insights</a> 网站测试工具来测试你的网站，它会告诉你，你的网站需要优化移动端还是桌面端。</p>
<p>Google 基于网页的渲染速度来打分。它会计算你的网站需要多久呈现到用户眼前。用户等待的时间越长，网站的得分就越低。</p>
<p>这是我的博客中<a target="_blank" rel="noopener" href="https://www.jaredwolff.com/homemade-indoor-air-quality-sensor/">某个页面</a>的得分情况：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gattxfqr8tj30k00fvwf6.jpg" alt="Screenshot of Pagespeed Insights"></p>
<p>这张截图是我优化了一些项目之后的结果。我移除了 Disqus 评论工具，嵌入了 CSS 和 JavaScript 文件。移动端的得分从 50 分（满分100分）上升到了90分。效果还不错。</p>
<p>我对 Google 的 Pagespeed Insights 测试工具的主要不满在于它太慢了。</p>
<p>可以说是……<strong>难以忍受的慢</strong>。</p>
<p>如何解决呢？</p>
<p><em>Lighthouse.</em></p>
<h3 id="使用-Lighthouse"><a href="#使用-Lighthouse" class="headerlink" title="使用 Lighthouse"></a>使用 Lighthouse</h3><p>你可以通过 <code>npm</code> 下载 <a target="_blank" rel="noopener" href="https://github.com/GoogleChrome/lighthouse">Lighthouse</a> 到电脑上。它实际上是一个功能更强大的 Pagespeed Insights 测试工具（Pagespeed Insights 是基于 Lighthouse 实现的）。</p>
<p>当你在本地使用它时，测试生成的所有信息都可以保存下来。</p>
<p>使用方法如下：</p>
<ol>
<li><p>下载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g lighthouse</span><br></pre></td></tr></table></figure>

<p>此外需要确保已经下载了某些版本的 Google Chrome 。我使用的是 <a target="_blank" rel="noopener" href="https://www.google.com/chrome/canary/">Chrome Canary</a>。</p>
</li>
<li><p>接下来你就可以使用它并生成测试结果了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lighthouse https://www.jarewolff.com --view</span><br></pre></td></tr></table></figure>

<p><code>--view</code> 会在你的默认浏览器中打开测试结果。以下是我之前使用 Lighthouse 测试的结果：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gatubnx4y7j30k00fvt9a.jpg" alt="Screenshot from Lighthouse"></p>
</li>
</ol>
<p>测试结果不仅包括性能得分，还包括可访问性、最佳实践和 SEO 建议。</p>
<p>它的不足之处是每次只能测试一个页面。我建议你测试内容较多的页面，这样一来，你测得的就是网站中性能最差的一页的结果。一旦你修复了最差的页面，整个网站的性能也会得到大幅提升。</p>
<h2 id="使用静态页面"><a href="#使用静态页面" class="headerlink" title="使用静态页面"></a>使用静态页面</h2><p><img src="https://www.jaredwolff.com/seven-ways-to-optimize-your-site-for-speed/images/Copy_of_Particle_Bluetooth-385a56b6-9f74-4a2d-9ab3-fd0ef8daa8a4.png" alt="Static site generator logos"></p>
<p>你还记得网页 100% 由 HTML 和 CSS 组成的年代吗？</p>
<p>在过去的几年里，我们从纯 HTML 到使用 Ruby on Rails ，再慢慢的回到纯 HTML 。</p>
<p>原因是什么呢？</p>
<p>速度。</p>
<p>当你访问使用 Flask, Ruby on Rails 或类似框架的网站时，会发生如下步骤：</p>
<ol>
<li>发出网页请求</li>
<li>服务器将你的网站组合起来</li>
<li>服务器将内容压缩打包</li>
<li>服务器把内容返回给浏览器</li>
</ol>
<p>这本身不会花费太长时间。但是当这个内容乘以 1000 或者 再乘以 10 时，就会遇到问题了。</p>
<p>如果能够一次拼凑所有的内容呢？</p>
<p>这就是静态网站的优势了。</p>
<p>我们来看看静态网站如何实现这一点：</p>
<h3 id="静态网站生成器如何工作？"><a href="#静态网站生成器如何工作？" class="headerlink" title="静态网站生成器如何工作？"></a>静态网站生成器如何工作？</h3><p>静态网站生成器包含一系列模板和样式。它们可以组合在一起，生成不同的内容。</p>
<p>作为后端，静态网站生成器使用 markdown，偶尔使用 JSON。</p>
<p>编译时，模板组合在一起。Markdown 被转换成 HTML，并注入到模板中。结果呢？一系列“看起来动态”的页面就生成了（就像你在我的网站上看到的那样）。</p>
<p>我的个人博客是基于 <a target="_blank" rel="noopener" href="https://gohugo.io/">Hugo</a> 实现的，我也尝试过 <a target="_blank" rel="noopener" href="https://middlemanapp.com/">Middleman</a> 和 <a target="_blank" rel="noopener" href="https://jekyllrb.com/">Jekyll</a> 。无论你的需求是什么，你总能找到一款符合你要求的静态网站生成器。Netlify 上有一个根据人气排列的静态生成器列表，可以在<a target="_blank" rel="noopener" href="https://www.staticgen.com/">这里</a>查看。</p>
<h3 id="丰富的插件"><a href="#丰富的插件" class="headerlink" title="丰富的插件"></a>丰富的插件</h3><p>静态网站生成器不仅能编译网站，还能优化、缩小和调整图片大小。这也是我建议使用静态网站生成器的原因。好好利用这些资源能够让你的网站速度得到显著的提升。</p>
<p>举个例子，我原本使用 <code>highlight.min.js</code> 来高亮代码。自从发现 Hugo 有自带的代码高亮功能后，我抛弃了 <code>highlight.min.js</code> 。Hugo 在代码块的 HTML 中注入了 CSS ，使页面呈现格式正确（且静态）的内容。</p>
<h2 id="嵌入-JavaScript-和-CSS"><a href="#嵌入-JavaScript-和-CSS" class="headerlink" title="嵌入 JavaScript 和 CSS"></a>嵌入 JavaScript 和 CSS</h2><p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gaty77uourj30k008xgm1.jpg" alt="Arrows"></p>
<p>正如我提到的那样，加载任何额外的资源都会对性能造成影响。</p>
<p>最近，Hugo 实现了将内容复制到最终的 HTML 代码中的功能。这对于加载 CSS 和 JavaScript 来说真是一个福音。这样一来，所有的资源都会加入到 HTML 文件中，而不需要任何额外的资源加载了。</p>
<p>举个例子，我把完整的 <code>style.css</code> 文件放在网站的 header 中，使得所有的样式都能立马生效。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Css--&gt;</span></span><br><span class="line">&#123;&#123;- $Style := resources.Get &quot;/css/style.css&quot; -&#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  &#123;&#123; ( $style | minify ).Content | safeCSS &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 footer 中，我将压缩过的 <code>lazysizes.min.js</code> 注入到 <code>&lt;script&gt;</code> 中，让它尽快被加载，因为它决定了网站的剩余部分将以何种方式加载。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Lazy Load Script --&gt;</span></span><br><span class="line">&#123;&#123;- $lazysizes := resources.Get &quot;/js/lazysizes.min.js&quot; -&#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  </span><span class="template-variable">&#123;&#123; ( <span class="name">$lazysizes</span> | minify ).Content | safeJS &#125;&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注意事项</strong>：<code>style.css</code> 和 <code>lazysizes.min.js</code> 文件都在主题文件夹中的 <code>assets</code> 文件夹内。 Hugo 使用 <code>assets</code> 文件夹来查找这些文件。如果你也使用 Hugo ，且希望嵌入自己的 css 和 javascript 文件，我建议你看看<a target="_blank" rel="noopener" href="https://gohugo.io/hugo-pipes/bundling/#readout">这里</a>。</p>
<p><strong>注意事项2</strong>：正如你看到的那样，我使用 Hugo 自带的 <code>minify</code> 功能来压缩嵌入的文件，但是这样只有 javascript 文件被压缩了，<code>style.css</code> 没有压缩。我会在<strong>使用 Gulp 优化</strong>这一节中讲到用别的方法来实现样式压缩。</p>
<h2 id="使用内置方法"><a href="#使用内置方法" class="headerlink" title="使用内置方法"></a>使用内置方法</h2><p>你或许已经注意到了，引入 javascript 文件会对网站的性能产生负面影响。无论在网站的哪项功能上引入都会降低性能。</p>
<p>比如，我们会使用表单的 javascript 库来完成校验，但是有更好的方法吗？</p>
<p>（其实是有的。）</p>
<p>你可以使用 HTML5 标签，如 <code>required</code> 或使用 <code>pattern</code> 在浏览器中完成校验。你可以看看我是如何实现<a target="_blank" rel="noopener" href="https://www.jaredwolff.com/about/">联系人表格</a>的。</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gaty724zg6j30k00kct9a.jpg" alt="Contact form Screenshot"></p>
<p>所有的校验都在浏览器中完成，不用额外引入 javascript ，不会因为加载而出现延迟。</p>
<p>关于如何实现这一点，<a target="_blank" rel="noopener" href="https://css-tricks.com/form-validation-part-1-constraint-validation-html/">这里</a>有一份很好的资料。Chris 还提供了一份关于 javascript 校验的详细说明，你可以进一步了解。</p>
<h2 id="组织代码"><a href="#组织代码" class="headerlink" title="组织代码"></a>组织代码</h2><p>Javascript 和 CSS 文件的位置也会影响性能。比如，我通常将 javascript 和 CSS 放在重要位置。主要的样式文件会放在 <code>&lt;head&gt;</code> 中，其余的则要么放在 footer 中，要么作为 HTML 的内联样式。类似的， javascript 文件则放在页面的底部。这样一来，所有重要的内容都会优先加载。</p>
<p>这是我组织 javascript 文件的例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.4.1.min.js&quot;</span>   <span class="attr">integrity</span>=<span class="string">&quot;sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=&quot;</span>   <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我希望你能尝试不同的方法来提升你的网站，看看它们效果的不同。如果能够不使用 javascript 库，我强烈建议你不要使用它们。</p>
<h2 id="延迟加载"><a href="#延迟加载" class="headerlink" title="延迟加载"></a>延迟加载</h2><p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gatyf1p4x0j30k00eqdg7.jpg" alt="Lazy Panda"></p>
<p>延迟加载能够有效延迟暂时看不见的资源的加载。正如 Google 所说，它能够提升“互动时间”的体验。此外，如果用户没有滚动页面，部分图片不会被加载，对于高流量的网站来说，这样可以节约带宽和金钱。</p>
<p>延迟加载通过 javascript 来实现，以下是实现延迟加载的一些库：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/aFarkas/lazysizes">Lazysizes</a>(⭐️ 11k) - 是实现延迟加载功能的最有人气的库了。它比同类的一些库要大。我试过用它来延迟加载内嵌框架和不会立马使用的 javascript 内容。例如，在我在一篇文章中内嵌了 <a target="_blank" rel="noopener" href="https://www.jaredwolff.com/homemade-indoor-air-quality-sensor/#live-example">google 文档表格</a>，在另一篇文章中则延迟加载了<a target="_blank" rel="noopener" href="https://www.jaredwolff.com/homemade-indoor-air-quality-sensor/#you-did-it">Youtube视频</a>。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/callmecavs/layzr.js">Layzr.js</a> (⭐️ 5.5k)- 只针对图片进行延迟加载</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ApoorvSaxena/lozad.js">lozad</a> (⭐️ 5.4k) - 它能实现 Lazysizes 的几乎所有功能，是基于Intersection Observer 接口实现的，而 Lazysizes 则使用了 Intersection Observer 和其他接口。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/malchata/yall.js">yall</a>（⭐️ 800) - 这个库也使用了 Intersection Observer 接口。</li>
</ul>
<h3 id="设置延迟加载"><a href="#设置延迟加载" class="headerlink" title="设置延迟加载"></a>设置延迟加载</h3><p>设置步骤非常简单，我以 <code>lazysizes</code> 为例。</p>
<ol>
<li><p>在 HTML 文件中引入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;lazysizes.min.js&quot;</span> <span class="attr">async</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（如果你使用 Hugo，也可以像我**嵌入 JavaScript 和 CSS ** 那样将 <code>lazysizes</code> 直接嵌入 HTML ）</p>
</li>
<li><p>给所有你想要延迟加载的内容加上 <code>lazyload</code> 类名</p>
</li>
<li><p>将 <code>src</code> 标签改为 <code>data-src</code></p>
</li>
</ol>
<h3 id="见证奇迹的时刻"><a href="#见证奇迹的时刻" class="headerlink" title="见证奇迹的时刻"></a>见证奇迹的时刻</h3><p>当用户访问你的网站时，延迟加载器会监控用户访问的每一处。当用户滚动页面时，加载器会立马加载即将显示的内容中被标记了 <code>lazyload</code> 类名的内容。</p>
<p>下面是在<a target="_blank" rel="noopener" href="https://www.jaredwolff.com/homemade-indoor-air-quality-sensor/#you-did-it">网页</a>上延迟加载Youtube视频的例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">class</span>=<span class="string">&quot;lazyload&quot;</span> <span class="attr">width</span>=<span class="string">&quot;700px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400px&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;https://www.youtube.com/embed/IR2W0GmRKk8&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> <span class="attr">allow</span>=<span class="string">&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot;</span> <span class="attr">allowfullscreen</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码让内嵌框架在用户滚动到内容附近时才开始加载。</p>
<h2 id="使用-Gulp-实现优化"><a href="#使用-Gulp-实现优化" class="headerlink" title="使用 Gulp 实现优化"></a>使用 Gulp 实现优化</h2><p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gau3sep6b0j30k00b9aa3.jpg" alt="Gulp logo"></p>
<p>Jekyll 或 Hugo 并不能实现所有的优化。那么你该怎么做呢？</p>
<p>使用 <code>gulp</code> 。</p>
<p>我选择使用 <code>gulp</code> 来优化我的 Hugo 网站，因为 <code>gulp</code> 有一系列成熟的插件来实现包括优化图片、压缩 HTML 文件等几乎所有的功能。</p>
<p>以下是我喜欢的一些插件：</p>
<p><code>gulp-uglify</code> - 用来压缩 javascript 。目前我只使用了一个 javascript 库。如果你的项目中有非常多的 JavaScript 库，那么一定要使用 <code>gulp-uglify</code> </p>
<p><code>gulp-htmlmin</code> - 压缩 HTML。它还能够压缩内联 Javascript 和 CSS。</p>
<p><code>gulp-imagemin</code> - 是对我来说最有用的插件。我用他来调整图片大小、转换图片格式为 jpg 或渐进式 jpeg。它不仅运行速度很快，当配合 <code>gulp-cache</code> 一同使用时，只用运行一次。尽管看起来有些复杂，但能够生成 Lighthouse 建议的图片大小。</p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>这里是我的 <code>gupfile.js</code> 文件中使用 <code>imagemin</code> 的部分代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;resize&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>([<span class="string">&quot;content/**/**/*.+(png|jpg|jpeg|gif)&quot;</span>])</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">cache</span>(<span class="title function_">imagemin</span>([</span><br><span class="line">      imagemingm.<span class="title function_">resize</span>(&#123;<span class="attr">width</span>: <span class="number">720</span>&#125;),</span><br><span class="line">      imagemingm.<span class="title function_">convert</span>(<span class="string">&#x27;jpg&#x27;</span>),</span><br><span class="line">      <span class="title function_">imageminmozjpeg</span>(&#123;<span class="attr">quality</span>: <span class="number">80</span>&#125;)</span><br><span class="line">    ],&#123;</span><br><span class="line">    <span class="attr">verbose</span>: <span class="literal">true</span></span><br><span class="line">    &#125;), &#123;</span><br><span class="line">      <span class="attr">fileCache</span>: <span class="keyword">new</span> <span class="title class_">Cache</span>(&#123; <span class="attr">tmpDir</span>: path.<span class="title function_">join</span>(process.<span class="property">env</span>.<span class="property">PWD</span>, <span class="string">&#x27;node_modules&#x27;</span>), <span class="attr">cacheDirName</span>: <span class="string">&#x27;.cache&#x27;</span> &#125;)</span><br><span class="line">    &#125;))</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;public/&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>以下是值得注意的事项：</p>
<ul>
<li>我使用了 <code>**</code> 通配符表示目录名中的任意值。依据图片路径的不同，你可能需要给文件路径增加一些 <code>**/</code>。当前的写法对我的文件结构来说是没问题的，如 <code>/contents/post-name/images/image-file.jpg</code></li>
<li>使用除了 <code>gulp-imagemin</code> 之外的插件可能会让人困惑。比如 <code>imageminmozjpeg</code>，同时使用需要在文件中分别引入。我会在我的文件顶部这样引入： <code>var imageminmozjpeg = require(‘imagemin-mozjpeg’);</code></li>
<li>最后，你会看到我使用了 <code>gulp-cache</code> 。这里的配置取决于你如何构建你的网站，你也许不用定义任何配置项。我的网站使用了 Netlify，想要使用 <code>gulp-cache</code> 就需要在 <code>node_module</code> 文件夹中定义 <code>tmpDir</code> 和 <code>cacheDirName</code>。这样一来，当你的网站搭建好的时候，你的缓存就被重新加载了，而无需调整图片大小。</li>
</ul>
<p>使用 <code>gulp-cache</code> 使我的构建 + 部署时间从 10 分钟减少到大约 60 秒。尽管缓存的大小有了少许增长，但是从时间成本来看是完全值得的。此外，我确信 Netlify 肯定很乐意我这么做。</p>
<h2 id="去繁就简"><a href="#去繁就简" class="headerlink" title="去繁就简"></a>去繁就简</h2><p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gau4f1u1inj30k00b9jrh.jpg" alt="Dirty hand print"></p>
<p>想要方便，就一定会有牺牲。</p>
<p>这是我从使用 Google 分析和类似 Disqus 服务中学会的道理。尤其是 Disqus 时常让我头疼。（如果你在使用 Disqus 的网站上查看过 Debug 调试台，你就会明白我为何这么说……）</p>
<p>我最近写了一篇<a target="_blank" rel="noopener" href="https://www.jaredwolff.com/how-to-setup-worry-free-blog-comments-in-less-than-20-simple-steps/">从 Disqus 切换到自己托管的 Commento 服务</a>的教程。它能带来两大收益：</p>
<ol>
<li><p>你能够掌控你的网站内容，你的网站上不会有随时会挂的第三方服务。（当然你需要给自己的内容备份，不用自己备份是付费服务相比自己托管业务的一大优势）</p>
</li>
<li><p>你的网站性能将会大幅提升。</p>
<p>我在移除 Disqus 之前和之后都做过性能测试，结果如前文所示，Disqus 会对网速和 CPU 使用都有极大的负面影响。</p>
<p>相比之下，Commento 非常轻量，且资源占用极低，非常适合静态生成网站使用。</p>
</li>
</ol>
<p>作为网站的构建者，你的网站质量和速度完全取决于网站的功能。记住，你总会有更好的选择，不要将你的灵魂出售给 Google, Disqus 或其他任何人。</p>
<h2 id="网站诊断"><a href="#网站诊断" class="headerlink" title="网站诊断"></a>网站诊断</h2><p>在这篇文章即将结束之时，我希望再给你介绍一件实用工具：<strong>Serpstat’s 网络诊断</strong>工具。</p>
<p>每隔一段时间我就会用它来诊断我的网站，它能够有效抓取网站上的各种错误。例如，它最近帮我发现网站上的一些损坏的图片。我修正了它们，然后一切又恢复了正常。</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gau4uj2cztj30k00fvdgo.jpg" alt="Screenshot of Serpstat Site Audit"></p>
<p>如果你希望你的网站上没有错误，那么像 Serpstat’s 这样的诊断工具正是你所需要的。</p>
<h2 id="永无止境"><a href="#永无止境" class="headerlink" title="永无止境"></a>永无止境</h2><p>这篇文章读完了，但是优化实践还没有结束。</p>
<p>提升活跃网站的性能这件事没有终点。尽管你已尽力而为，但你仍可以花几天时间优化图形和延迟加载。归根到底，有哪些是值得的？这是我仍在问自己的一个问题。</p>
<p>希望这篇文章对你有用。你最大的收获是什么？有哪些优化建议是我没有提到的？请在下面的评论中留言！</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/translation/" rel="tag"># translation</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/02/17/%E3%80%90%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E3%80%91%E7%AE%80%E7%BA%A6%E8%87%B3%E4%B8%8A/" rel="prev" title="【读书笔记】简约至上">
                  <i class="fa fa-angle-left"></i> 【读书笔记】简约至上
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/02/23/Week-8/" rel="next" title="Week 8">
                  Week 8 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2018 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-user"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Xu Quan（Nikkkki）</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"IcWbltr2BErnzeh08rQq5Awt-MdYXbMMI","app_key":"MBmkp7Em4UZXFeXVz4D0XIL2","server_url":null,"security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"xuquan","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
